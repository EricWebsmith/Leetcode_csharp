namespace Leetcode1926;


public class Solution
{
    int[][] directions = new int[4][]
    {
        new int[]{-1, 0},
        new int[]{0, -1},
        new int[]{1, 0},
        new int[]{0, 1},
    };

    public int NearestExit(char[][] maze, int[] entrance)
    {
        int m = maze.Length;
        int n = maze[0].Length;
        Queue<int[]> q = new Queue<int[]>();
        q.Enqueue(entrance);

        bool[][] visited = new bool[m][];
        for (int r = 0; r < m; r++)
        {
            visited[r] = new bool[n];
        }

        int ans = 0;
        while (q.Count > 0)
        {
            int qCount = q.Count;
            while (qCount > 0)
            {
                int[] point = q.Dequeue();
                qCount--;
                int r = point[0];
                int c = point[1];
                bool isEntrance = false;
                isEntrance = r == entrance[0] && c == entrance[1];

                if (visited[r][c])
                {
                    continue;
                }

                visited[r][c] = true;
                foreach (int[] d in directions)
                {
                    int newR = r + d[0];
                    int newC = c + d[1];
                    if (newR == -1 || newR == m || newC == -1 || newC == n)
                    {
                        if (isEntrance)
                        {
                            continue;
                        }
                        return ans;
                    }

                    if (maze[newR][newC] == '+')
                    {
                        continue;
                    }
                    else
                    {
                        q.Enqueue(new int[] { newR, newC });
                    }

                }
            }
            ans++;

            if (q.Count == 0)
            {
                return -1;
            }
        }
        return ans;
    }
}


[TestClass]
public class SolutionTests
{
    private void TestBase(string mazeStr, string entranceStr, int expected)
    {
        char[][] maze = mazeStr.LeetcodeToCharArray2D();
        int[] entrance = entranceStr.LeetcodeToArray();
        int actual = new Solution().NearestExit(maze, entrance);
        Assert.AreEqual(expected, actual);
    }

    [TestMethod] public void Test1() { TestBase("[[+,+,.,+],[.,.,.,+],[+,+,+,.]]", "1,2", 1); }
    [TestMethod] public void Test2() { TestBase("[[+,+,+],[.,.,.],[+,+,+]]", "1,0", 2); }
    [TestMethod] public void Test3() { TestBase("[[.,+]]", "0,0", -1); }
    string test4maze = "[[++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][+..................................................................................................+][++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++]]";
    [TestMethod] public void Test4() { TestBase(test4maze, "42,4", -1); }

}

/*
Runtime: 200 ms, faster than 85.71% of C# online submissions for Nearest Exit from Entrance in Maze.
Memory Usage: 43.7 MB, less than 12.50% of C# online submissions for Nearest Exit from Entrance in Maze.
 */